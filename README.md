# DeepAudit Nexus

æ”¯æŒ MCP åè®®çš„é«˜çº§å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰ä»£ç å®¡è®¡å·¥å…·ï¼Œé›†æˆäº† Rust AST å¼•æ“å’Œ Python MCP æœåŠ¡å™¨ã€‚

## æ¶æ„æ¦‚è§ˆ

DeepAudit é‡‡ç”¨æ··åˆæ¶æ„è®¾è®¡ï¼Œç»“åˆäº† Rust çš„æ€§èƒ½ä¼˜åŠ¿å’Œ Python çš„ç”Ÿæ€ä¸°å¯Œæ€§ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å‰ç«¯ (React)   â”‚â—„â”€â”€â–ºâ”‚  Tauri (Rust)    â”‚â—„â”€â”€â–ºâ”‚ Python Sidecar  â”‚
â”‚                 â”‚    â”‚                  â”‚    â”‚                 â”‚
â”‚ â€¢ React 19      â”‚    â”‚ â€¢ AST å¼•æ“       â”‚    â”‚ â€¢ MCP æœåŠ¡å™¨     â”‚
â”‚ â€¢ TypeScript    â”‚    â”‚ â€¢ æ–‡ä»¶ç³»ç»Ÿæ“ä½œ   â”‚    â”‚ â€¢ å®‰å…¨æ‰«æ       â”‚
â”‚ â€¢ Vite          â”‚    â”‚ â€¢ å¯¹è¯æ¡†ç®¡ç†     â”‚    â”‚ â€¢ æŠ¥å‘Šç”Ÿæˆ       â”‚
â”‚ â€¢ Tailwind CSS  â”‚    â”‚ â€¢ SQL æ•°æ®åº“      â”‚    â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒç»„ä»¶

- **å‰ç«¯**ï¼šReact 19 + TypeScript + Vite + Tailwind CSS
- **åç«¯**ï¼šRust (Tauri 2.x) + SQLx (SQLite)
- **AST å¼•æ“**ï¼šRust (tree-sitter) æ”¯æŒå¤šè¯­è¨€è§£æ
- **MCP æœåŠ¡**ï¼šPython FastMCP æœåŠ¡å™¨ï¼Œæä¾›é«˜çº§åˆ†æå·¥å…·
- **UI æ¡†æ¶**ï¼šRadix UI + Lucide React + Framer Motion

## å‰ç½®ä¾èµ–

### å¿…éœ€ä¾èµ–
- **Node.js** (æ¨è v18+) 
- **Rust** (æœ€æ–°ç¨³å®šç‰ˆ)
- **Python 3.8+**
- **Tauri CLI** 
  ```bash
  npm install -g @tauri-apps/cli
  ```

### å¯é€‰ä¾èµ–
- **Git** (ç”¨äºç‰ˆæœ¬æ§åˆ¶é›†æˆ)

## å®‰è£…æ­¥éª¤

### 1. å…‹éš†é¡¹ç›®
```bash
git clone <repository-url>
cd DeepAudit
```

### 2. å®‰è£…å‰ç«¯ä¾èµ–
```bash
npm install
```

### 3. å®‰è£… Python ä¾èµ–
```bash
cd python-sidecar
pip install -r requirements.txt
cd ..
```

### 4. å®‰è£… Rust ä¾èµ–
```bash
cd src-tauri
cargo fetch
cd ..
```

## è¿è¡Œæ–¹å¼

### å¼€å‘æ¨¡å¼
```bash
npm run tauri dev
```

### ç”Ÿäº§æ„å»º
```bash
npm run tauri build
```

### ä»…å‰ç«¯å¼€å‘
```bash
npm run dev
```

## ğŸ“‹ ä½¿ç”¨æŒ‡å—

### åŸºæœ¬å·¥ä½œæµ

1. **å¯åŠ¨åº”ç”¨**ï¼šè¿è¡Œ `npm run tauri dev`
2. **æ‰“å¼€é¡¹ç›®**ï¼šç‚¹å‡» "æ‰“å¼€é¡¹ç›®..." æŒ‰é’®é€‰æ‹©ä»£ç ç›®å½•
3. **æ„å»ºç´¢å¼•**ï¼šä½¿ç”¨ `build_ast_index` å·¥å…·æ„å»º AST ç´¢å¼•
4. **æ‰§è¡Œåˆ†æ**ï¼šè¿è¡Œå®‰å…¨æ‰«ææˆ–ä»£ç ç»“æ„åˆ†æ
5. **æŸ¥çœ‹ç»“æœ**ï¼šåœ¨æ—¥å¿—é¢æ¿æŸ¥çœ‹åˆ†æç»“æœ

### å¿«æ·åŠŸèƒ½

- **é¡¹ç›®æ–‡ä»¶æ ‘**ï¼šè‡ªåŠ¨æ˜¾ç¤ºé¡¹ç›®ç»“æ„
- **å®æ—¶æ—¥å¿—**ï¼šåˆ†æ‰¹æ˜¾ç¤º Rust å’Œ Python æ—¥å¿—
- **å·¥å…·æè¿°**ï¼šæ‚¬åœæŸ¥çœ‹ MCP å·¥å…·è¯¦ç»†è¯´æ˜
- **ä¸€é”®æ¸…ç†**ï¼šæ¸…é™¤æ—¥å¿—å’Œæ–‡ä»¶æ ‘ç¼“å­˜

## ğŸ”§ MCP å·¥å…·é›†

DeepAudit æä¾› 14 ä¸ª MCP å·¥å…·ï¼Œåˆ†ä¸ºä»¥ä¸‹ç±»åˆ«ï¼š

### æ ¸å¿ƒåˆ†æå·¥å…·

| å·¥å…·åç§° | å‚æ•° | æè¿° |
| :--- | :--- | :--- |
| **build_ast_index** | `directory` | æ„å»º AST ç´¢å¼•ï¼Œæ”¯æŒå¤šè¯­è¨€ä»£ç è§£æã€‚åˆå§‹åŒ–é¡¹ç›®çš„å¿…éœ€æ­¥éª¤ |
| **run_security_scan** | `directory`, `custom_rules`, `include_dirs`, `exclude_dirs` | ä½¿ç”¨è‡ªå®šä¹‰è§„åˆ™è¿è¡Œå®‰å…¨æ‰«æï¼Œæ”¯æŒç›®å½•è¿‡æ»¤ |
| **get_analysis_report** | `directory` | è·å–ç¼“å­˜çš„è¯¦ç»†åˆ†ææŠ¥å‘Šï¼ˆJSON æ ¼å¼ï¼‰ |
| **get_knowledge_graph** | `limit` | è·å–é¡¹ç›®çš„ä»£ç çŸ¥è¯†å›¾è°±ï¼ˆèŠ‚ç‚¹ä¸å…³ç³»ï¼‰ |
| **verify_finding** | `file`, `line`, `description`, `vuln_type`, `code` | ä½¿ç”¨ LLM éªŒè¯å®‰å…¨æ¼æ´çš„çœŸå®æ€§ |
| **analyze_code_with_llm** | `code`, `context` | ä½¿ç”¨ LLM åˆ†æä»£ç ç‰‡æ®µçš„é€»è¾‘æˆ–ç¼ºé™· |

### æ–‡ä»¶æ“ä½œå·¥å…·

| å·¥å…·åç§° | å‚æ•° | æè¿° |
| :--- | :--- | :--- |
| **list_files** | `directory` | åˆ—å‡ºç›®å½•å†…å®¹ï¼ˆéé€’å½’ï¼‰ |
| **read_file** | `file_path` | è¯»å–æ–‡ä»¶å®Œæ•´å†…å®¹ |
| **search_files** | `directory`, `pattern` | æ­£åˆ™è¡¨è¾¾å¼æœç´¢æ–‡ä»¶å†…å®¹ |
| **get_code_structure** | `file_path` | è§£ææ–‡ä»¶ç»“æ„ï¼ˆç±»ã€å‡½æ•°ã€æ–¹æ³•ï¼‰ |

### ä»£ç å¯¼èˆªå·¥å…·

| å·¥å…·åç§° | å‚æ•° | æè¿° |
| :--- | :--- | :--- |
| **search_symbol** | `query` | åœ¨å…¨å±€ AST ç´¢å¼•ä¸­æœç´¢ç¬¦å·å®šä¹‰ |
| **find_call_sites** | `directory`, `symbol` | æŸ¥æ‰¾å‡½æ•°/æ–¹æ³•çš„æ‰€æœ‰è°ƒç”¨ä½ç½® |
| **get_call_graph** | `directory`, `entry`, `max_depth` | ç”Ÿæˆå‡½æ•°è°ƒç”¨å…³ç³»å›¾ |
| **get_class_hierarchy** | `directory`, `class_name` | è·å–ç±»çš„ç»§æ‰¿å…³ç³» |

## æ”¯æŒçš„ç¼–ç¨‹è¯­è¨€

Rust AST å¼•æ“æ”¯æŒä»¥ä¸‹è¯­è¨€çš„è§£æï¼š

- **Web**: JavaScript, TypeScript, HTML, CSS, JSON
- **åç«¯**: Python, Java, Rust, Go, C/C++
- **æ‰©å±•æ€§**: å¯é€šè¿‡ tree-sitter æ·»åŠ æ–°è¯­è¨€æ”¯æŒ

## ç¼“å­˜æœºåˆ¶

### ç¼“å­˜ä½ç½®
- **AST ç´¢å¼•**: `.deepaudit_cache/<repo_hash>/ast_index.bin`
- **åˆ†ææŠ¥å‘Š**: `.deepaudit_cache/<repo_hash>/analysis_report.json`

### ç¼“å­˜ç­–ç•¥
- **æ™ºèƒ½å¤±æ•ˆ**: æ–‡ä»¶ä¿®æ”¹æ—¶é—´å˜åŒ–æ—¶è‡ªåŠ¨é‡å»º
- **è·¨ä¼šè¯æŒä¹…**: å…³é—­åº”ç”¨åç¼“å­˜ä¿ç•™
- **å†…å­˜ä¼˜åŒ–**: å¤§å‹é¡¹ç›®åˆ†æ‰¹å¤„ç†ï¼Œé¿å…å†…å­˜æº¢å‡º


## å¼€å‘æŒ‡å—

### é¡¹ç›®ç»“æ„
```
DeepAudit/
â”œâ”€â”€ src/                    # React å‰ç«¯æºç 
â”‚   â”œâ”€â”€ components/         # UI ç»„ä»¶
â”‚   â”œâ”€â”€ lib/               # å·¥å…·å‡½æ•°
â”‚   â””â”€â”€ App.tsx            # ä¸»åº”ç”¨ç»„ä»¶
â”œâ”€â”€ src-tauri/             # Rust åç«¯æºç 
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ ast/           # AST å¼•æ“
â”‚   â”‚   â”œâ”€â”€ lib.rs         # Tauri å‘½ä»¤
â”‚   â”‚   â””â”€â”€ scanner.rs     # æ–‡ä»¶æ‰«æå™¨
â”‚   â””â”€â”€ Cargo.toml         # Rust ä¾èµ–
â”œâ”€â”€ python-sidecar/        # Python MCP æœåŠ¡
â”‚   â”œâ”€â”€ agent.py           # MCP å·¥å…·å®šä¹‰
â”‚   â”œâ”€â”€ ast_engine.py      # Python AST å¤„ç†
â”‚   â””â”€â”€ requirements.txt   # Python ä¾èµ–
â””â”€â”€ dist/                  # æ„å»ºè¾“å‡º
```

### æ·»åŠ æ–°çš„ MCP å·¥å…·

1. **Python ç«¯**ï¼šåœ¨ `python-sidecar/agent.py` ä¸­æ·»åŠ  `@mcp.tool()` è£…é¥°çš„å‡½æ•°
2. **å‰ç«¯ç«¯**ï¼šåœ¨ `src/App.tsx` çš„ `MCP_TOOL_DESCRIPTIONS` ä¸­æ·»åŠ å·¥å…·æè¿°
3. **ç±»å‹å®‰å…¨**ï¼šç¡®ä¿å‚æ•°å’Œè¿”å›å€¼çš„ JSON åºåˆ—åŒ–å…¼å®¹æ€§
